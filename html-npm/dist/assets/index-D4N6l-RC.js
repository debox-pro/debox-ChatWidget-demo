(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))c(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&c(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();const C="modulepreload",b=function(n,e){return new URL(n,e).href},v={},P=function(e,t,c){let o=Promise.resolve();if(t&&t.length>0){const s=document.getElementsByTagName("link"),i=document.querySelector("meta[property=csp-nonce]"),d=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(t.map(a=>{if(a=b(a,c),a in v)return;v[a]=!0;const f=a.endsWith(".css"),E=f?'[rel="stylesheet"]':"";if(!!c)for(let h=s.length-1;h>=0;h--){const g=s[h];if(g.href===a&&(!f||g.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${a}"]${E}`))return;const l=document.createElement("link");if(l.rel=f?"stylesheet":C,f||(l.as="script"),l.crossOrigin="",l.href=a,d&&l.setAttribute("nonce",d),document.head.appendChild(l),f)return new Promise((h,g)=>{l.addEventListener("load",h),l.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${a}`)))})}))}function r(s){const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=s,window.dispatchEvent(i),!i.defaultPrevented)throw s}return o.then(s=>{for(const i of s||[])i.status==="rejected"&&r(i.reason);return e().catch(r)})};var D=Object.defineProperty,I=Object.getOwnPropertySymbols,L=Object.prototype.hasOwnProperty,x=Object.prototype.propertyIsEnumerable,y=(n,e,t)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t,w=(n,e)=>{for(var t in e||(e={}))L.call(e,t)&&y(n,t,e[t]);if(I)for(var t of I(e))x.call(e,t)&&y(n,t,e[t]);return n};class u{constructor(){this.tag=null,this.config={zIndex:"999",projectId:"",conversationId:"",containerDomId:void 0}}static getInstance(){return u.instance||(u.instance=new u),u.instance}initMain(e){this.config=w(w({},this.config),e),this.tag=document.createElement("debox-chat-widget"),this.tag.style.zIndex=this.config.zIndex,this.tag.projectId=this.config.projectId,this.tag.conversationId=this.config.conversationId;let t=document.body;if(this.config.containerDomId){const c=document.getElementById(this.config.containerDomId);c&&(t=c)}t.appendChild(this.tag)}async init(e){if(this.tag)throw new Error("DeBoxChatWidget is already initialized");this.initMain(e),typeof window<"u"&&await P(()=>import("./index-edmGBYiJ.js"),[],import.meta.url)}destroy(){this.tag&&(this.tag.remove(),this.tag=null),this.config={zIndex:"999",projectId:"",conversationId:"",containerDomId:void 0}}setConversation(e){if(!this.tag)throw new Error("DeBoxChatWidget is not initialized");this.config.conversationId=e,this.tag.conversationId=e}addEventListener(e){if(!this.tag)throw new Error("DeBoxChatWidget is not initialized");this.tag.addEventListener("debox-message-pushed",e)}removeEventListener(e){if(!this.tag)throw new Error("DeBoxChatWidget is not initialized");this.tag.removeEventListener("debox-message-pushed",e)}}const m=u.getInstance();function p(n){return new URL(window.location.href).searchParams.get(n)}m.init({projectId:p("project_id")??void 0,zIndex:"9999",containerDomId:"test-dom"});async function B(){const n=p("group_name"),e=p("chain_id"),t=p("contract_address");if(n||e||t){const c=n?encodeURIComponent(n):"",o=e?encodeURIComponent(e):"",r=t?encodeURIComponent(t):"",s=`https://demo-chat.debox.pro/getconversationid?group_name=${c}&chain_id=${o}&contract_address=${r}`;try{const d=await(await fetch(s)).json();if(d.success){const a=d.data.cid;m.setConversation(a)}else console.warn("Failed to retrieve Conversation ID during initialization")}catch(i){console.error("Error fetching Conversation ID during initialization",i)}}}B();async function O(){const n=document.getElementById("groupName").value,e=document.getElementById("chainId").value,t=document.getElementById("contractAddress").value,c=n?encodeURIComponent(n):"",o=e?encodeURIComponent(e):"",r=t?encodeURIComponent(t):"";if(!c&&!o&&!r){alert("Please fill in at least one field.");return}const s=`https://demo-chat.debox.pro/getconversationid?group_name=${c}&chain_id=${o}&contract_address=${r}`;try{const d=await(await fetch(s)).json();if(d.success){const a=d.data.cid;document.getElementById("conversationInput").value=a,alert(`Conversation ID: ${a}`)}else alert("Failed to get Conversation ID")}catch(i){alert("Error fetching Conversation ID"),console.error(i)}}function j(){const n=document.getElementById("conversationInput").value;n?m.setConversation(n):alert("Please enter a valid Conversation ID")}m.addEventListener(n=>{const e=document.getElementById("events"),t=document.createElement("li");t.innerHTML=JSON.stringify(n.detail),e.appendChild(t)});window.getConversationId=O;window.setConversationFromInput=j;window.DeBoxChatWidget=m;
